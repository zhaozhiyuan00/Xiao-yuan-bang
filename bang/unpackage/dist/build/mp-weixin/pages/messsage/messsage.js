(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/messsage/messsage"],{"733a":function(i,g,t){"use strict";(function(i){t("a38e");e(t("66fd"));var g=e(t("e55e"));function e(i){return i&&i.__esModule?i:{default:i}}i(g.default)}).call(this,t("543d")["createPage"])},"77a2":function(i,g,t){"use strict";(function(i){Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var t={data:function(){return{textMsg:"",scrollAnimation:!1,scrollTop:0,scrollToView:"",msgList:[],msgImgList:[],myuid:0,RECORDER:i.getRecorderManager(),isVoice:!1,voiceTis:"按住 说话",recordTis:"手指上滑 取消发送",recording:!1,willStop:!1,initPoint:{identifier:0,Y:0},recordTimer:null,recordLength:0,AUDIO:i.createInnerAudioContext(),playMsgid:null,VoiceTimer:null,showEmji:"",emojiList:[],onlineEmoji:{"100.gif":"AbNQgA.gif","101.gif":"AbN3ut.gif","102.gif":"AbNM3d.gif","103.gif":"AbN8DP.gif","104.gif":"AbNljI.gif","105.gif":"AbNtUS.gif","106.gif":"AbNGHf.gif","107.gif":"AbNYE8.gif","108.gif":"AbNaCQ.gif","109.gif":"AbNN4g.gif","110.gif":"AbN0vn.gif","111.gif":"AbNd3j.gif","112.gif":"AbNsbV.gif","113.gif":"AbNwgs.gif","114.gif":"AbNrD0.gif","115.gif":"AbNDuq.gif","116.gif":"AbNg5F.gif","117.gif":"AbN6ET.gif","118.gif":"AbNcUU.gif","119.gif":"AbNRC4.gif","120.gif":"AbNhvR.gif","121.gif":"AbNf29.gif","122.gif":"AbNW8J.gif","123.gif":"AbNob6.gif","124.gif":"AbN5K1.gif","125.gif":"AbNHUO.gif","126.gif":"AbNIDx.gif","127.gif":"AbN7VK.gif","128.gif":"AbNb5D.gif","129.gif":"AbNX2d.gif","130.gif":"AbNLPe.gif","131.gif":"AbNjxA.gif","132.gif":"AbNO8H.gif","133.gif":"AbNxKI.gif","134.gif":"AbNzrt.gif","135.gif":"AbU9Vf.gif","136.gif":"AbUSqP.gif","137.gif":"AbUCa8.gif","138.gif":"AbUkGQ.gif","139.gif":"AbUFPg.gif","140.gif":"AbUPIS.gif","141.gif":"AbUZMn.gif","142.gif":"AbUExs.gif","143.gif":"AbUA2j.gif","144.gif":"AbUMIU.gif","145.gif":"AbUerq.gif","146.gif":"AbUKaT.gif","147.gif":"AbUmq0.gif","148.gif":"AbUuZV.gif","149.gif":"AbUliF.gif","150.gif":"AbU1G4.gif","151.gif":"AbU8z9.gif","152.gif":"AbU3RJ.gif","153.gif":"AbUYs1.gif","154.gif":"AbUJMR.gif","155.gif":"AbUadK.gif","156.gif":"AbUtqx.gif","157.gif":"AbUUZ6.gif","158.gif":"AbUBJe.gif","159.gif":"AbUdIO.gif","160.gif":"AbU0iD.gif","161.gif":"AbUrzd.gif","162.gif":"AbUDRH.gif","163.gif":"AbUyQA.gif","164.gif":"AbUWo8.gif","165.gif":"AbU6sI.gif","166.gif":"AbU2eP.gif","167.gif":"AbUcLt.gif","168.gif":"AbU4Jg.gif","169.gif":"AbURdf.gif","170.gif":"AbUhFS.gif","171.gif":"AbU5WQ.gif","172.gif":"AbULwV.gif","173.gif":"AbUIzj.gif","174.gif":"AbUTQs.gif","175.gif":"AbU7yn.gif","176.gif":"AbUqe0.gif","177.gif":"AbUHLq.gif","178.gif":"AbUOoT.gif","179.gif":"AbUvYF.gif","180.gif":"AbUjFU.gif","181.gif":"AbaSSJ.gif","182.gif":"AbUxW4.gif","183.gif":"AbaCO1.gif","184.gif":"Abapl9.gif","185.gif":"Aba9yR.gif","186.gif":"AbaFw6.gif","187.gif":"Abaiex.gif","188.gif":"AbakTK.gif","189.gif":"AbaZfe.png","190.gif":"AbaEFO.gif","191.gif":"AbaVYD.gif","192.gif":"AbamSH.gif","193.gif":"AbaKOI.gif","194.gif":"Abanld.gif","195.gif":"Abau6A.gif","196.gif":"AbaQmt.gif","197.gif":"Abal0P.gif","198.gif":"AbatpQ.gif","199.gif":"Aba1Tf.gif","200.png":"Aba8k8.png","201.png":"AbaGtS.png","202.png":"AbaJfg.png","203.png":"AbaNlj.png","204.png":"Abawmq.png","205.png":"AbaU6s.png","206.png":"AbaaXn.png","207.png":"Aba000.png","208.png":"AbarkT.png","209.png":"AbastU.png","210.png":"AbaB7V.png","211.png":"Abafn1.png","212.png":"Abacp4.png","213.png":"AbayhF.png","214.png":"Abag1J.png","215.png":"Aba2c9.png","216.png":"AbaRXR.png","217.png":"Aba476.png","218.png":"Abah0x.png","219.png":"Abdg58.png"}}},onLoad:function(i){var g=this;JSON.parse(i.Jsonstr);this.AUDIO.onEnded((function(i){g.playMsgid=null})),this.RECORDER.onStart((function(i){g.recordBegin(i)})),this.RECORDER.onStop((function(i){g.recordEnd(i)}))},methods:{getMsgList:function(){for(var i=[{id:0,uid:0,username:"大黑哥",face:"/static/img/face.jpg",time:"12:56",type:"text",msg:{content:"为什么温度会相差那么大？"}},{id:1,uid:1,username:"售后客服008",face:"/static/img/im/face/face_2.jpg",time:"12:57",type:"text",msg:{content:"这个是有偏差的，两个温度相差十几二十度是很正常的，如果相差五十度，那即是质量问题了。"}},{id:2,uid:1,username:"售后客服008",face:"/static/img/im/face/face_2.jpg",time:"12:59",type:"voice",msg:{url:"/static/voice/3.aac",length:"00:06"}},{id:3,uid:0,username:"大黑哥",face:"/static/img/face.jpg",time:"13:05",type:"voice",msg:{url:"/static/voice/2.mp3",length:"00:06"}},{id:4,uid:0,username:"大黑哥",face:"/static/img/face.jpg",time:"13:05",type:"img",msg:{url:"/static/img/goods/p10.jpg",w:200,h:200}},{id:5,uid:1,username:"售后客服008",face:"/static/img/im/face/face_2.jpg",time:"12:59",type:"img",msg:{url:"/static/img/q.jpg",w:1920,h:1080}}],g=0;g<i.length;g++)"img"==i[g].type&&(i[g]=this.setPicSize(i[g]),this.msgImgList.push(i[g].msg.url));this.msgList=i,this.$nextTick((function(){this.scrollTop=9999,this.scrollAnimation=!0}))},setPicSize:function(g){var t=i.upx2px(350),e=i.upx2px(350);if(g.msg.w>t||g.msg.h>e){var f=g.msg.w/g.msg.h;g.msg.w>g.msg.h?(g.msg.w=t,g.msg.h=g.msg.w/f):(g.msg.h=e,g.msg.w=g.msg.h*f)}return g},screenMsg:function(g){switch(g.uid!=this.myuid&&i.vibrateLong(),g.type){case"text":this.addTextMsg(g);break;case"voice":this.addVoiceMsg(g);break;case"img":this.addImgMsg(g);break}this.$nextTick((function(){this.scrollToView="msg"+g.id}))},chooseEmoji:function(){this.showEmji="showEmoji"==this.showEmji?"hideEmoji":"showEmoji"},hideEmoji:function(){this.showEmji="showEmoji"==this.showEmji?"hideEmoji":""},addEmoji:function(i){this.textMsg+=i.alt},sendText:function(){if(this.hideEmoji(),this.textMsg){var i=this.replaceEmoji(this.textMsg),g={content:i};this.sendMsg(g,"text"),this.textMsg=""}},replaceEmoji:function(i){var g=this,t=i.replace(/\[([^(\]|\[)]*)\]/g,(function(i,t){for(var e=0;e<g.emojiList.length;e++)for(var f=g.emojiList[e],s=0;s<f.length;s++){var n=f[s];if(n.alt==i){var o="https://s2.ax1x.com/2019/04/12/",c='<img src="'+o+g.onlineEmoji[n.url]+'">';return c}}}));return'<div style="display: flex;align-items: center;">'+t+"</div>"},chooseImage:function(){var g=this;this.hideEmoji(),i.chooseImage({sizeType:["original","compressed"],success:function(t){for(var e=function(e){i.getImageInfo({src:t.tempFilePaths[e],success:function(i){var f={url:t.tempFilePaths[e],w:i.width,h:i.height};g.sendMsg(f,"img")}})},f=0;f<t.tempFilePaths.length;f++)e(f)}})},sendMsg:function(i,g){var t=this,e=new Date,f=this.msgList[this.msgList.length-1].id;f++;var s={id:f,uid:0,username:"大黑哥",face:"/static/img/face.jpg",time:e.getHours()+":"+e.getMinutes(),type:g,msg:i};this.screenMsg(s),setTimeout((function(){f=t.msgList[t.msgList.length-1].id,f++,s={id:f,uid:1,username:"售后客服008",face:"/static/img/im/face/face_2.jpg",time:e.getHours()+":"+e.getMinutes(),type:g,msg:i},t.screenMsg(s)}),3e3)},addTextMsg:function(i){this.msgList.push(i)},addVoiceMsg:function(i){this.msgList.push(i)},addImgMsg:function(i){i=this.setPicSize(i),this.msgImgList.push(i.msg.url),this.msgList.push(i)},showPic:function(g){i.previewImage({indicator:"none",current:g.msg.url,urls:this.msgImgList})},playVoice:function(i){this.playMsgid=i.id,this.AUDIO.src=i.msg.url,this.AUDIO.play()},voiceBegin:function(i){i.touches.length>1||(this.initPoint.Y=i.touches[0].clientY,this.initPoint.identifier=i.touches[0].identifier,this.RECORDER.start({format:"aac"}))},recordBegin:function(i){var g=this;this.recording=!0,this.voiceTis="松开 结束",this.recordLength=0,this.recordTimer=setInterval((function(){g.recordLength++}),1e3)},voiceCancel:function(){this.recording=!1,this.voiceTis="按住 说话",this.recordTis="手指上滑 取消发送",this.willStop=!0,this.RECORDER.stop()},voiceIng:function(g){if(this.recording){var t=g.touches[0];this.initPoint.Y-t.clientY>=i.upx2px(100)?(this.willStop=!0,this.recordTis="松开手指 取消发送"):(this.willStop=!1,this.recordTis="手指上滑 取消发送")}},voiceEnd:function(i){this.recording&&(this.recording=!1,this.voiceTis="按住 说话",this.recordTis="手指上滑 取消发送",this.RECORDER.stop())},recordEnd:function(i){if(clearInterval(this.recordTimer),!this.willStop){plus.io.resolveLocalFileSystemURL(i.tempFilePath,(function(i){i.file((function(i){}))}),(function(i){alert("Resolve file URL failed: "+i.message)}));var g={length:0,url:i.tempFilePath},t=parseInt(this.recordLength/60),e=this.recordLength%60;t=t<10?"0"+t:t,e=e<10?"0"+e:e,g.length=t+":"+e,this.sendMsg(g,"voice")}this.willStop=!1},switchVoice:function(){this.hideEmoji(),this.isVoice=!this.isVoice},discard:function(){}}};g.default=t}).call(this,t("543d")["default"])},"7ffb":function(i,g,t){},a390:function(i,g,t){"use strict";var e=t("7ffb"),f=t.n(e);f.a},b92c:function(i,g,t){"use strict";var e;t.d(g,"b",(function(){return f})),t.d(g,"c",(function(){return s})),t.d(g,"a",(function(){return e}));var f=function(){var i=this,g=i.$createElement;i._self._c},s=[]},bd32:function(i,g,t){"use strict";t.r(g);var e=t("77a2"),f=t.n(e);for(var s in e)"default"!==s&&function(i){t.d(g,i,(function(){return e[i]}))}(s);g["default"]=f.a},e55e:function(i,g,t){"use strict";t.r(g);var e=t("b92c"),f=t("bd32");for(var s in f)"default"!==s&&function(i){t.d(g,i,(function(){return f[i]}))}(s);t("a390");var n,o=t("f0c5"),c=Object(o["a"])(f["default"],e["b"],e["c"],!1,null,null,null,!1,e["a"],n);g["default"]=c.exports}},[["733a","common/runtime","common/vendor"]]]);